# Anime-Sama API Documentation

## Vue d'ensemble

Cette API permet d'accÃ©der aux donnÃ©es d'anime-sama.fr en temps rÃ©el, incluant la recherche, les dÃ©tails d'anime, les Ã©pisodes, et le support multilingue complet.

**URL de base :** `http://localhost:5000` (dÃ©veloppement)

## Authentification

Aucune authentification requise. L'API est publique et gratuite.

## SystÃ¨me de Langues

L'API supporte toutes les langues disponibles sur anime-sama.fr :

| Code | Nom | Description |
|------|-----|-------------|
| `vostfr` | VOSTFR | Version Originale Sous-TitrÃ©e FranÃ§aise |
| `vf` | VF | Version FranÃ§aise |
| `va` | VA | Version Anglaise |
| `vkr` | VKR | Version CorÃ©enne |
| `vcn` | VCN | Version Chinoise |
| `vqc` | VQC | Version QuÃ©bÃ©coise |
| `vf1` | VF1 | Version FranÃ§aise 1 (ADN) |
| `vf2` | VF2 | Version FranÃ§aise 2 (Netflix) |
| `vj` | VJ | Version Japonaise Sous-TitrÃ©e FranÃ§aise |

## Endpoints

### 1. Recherche d'anime

**Endpoint :** `GET /api/search`

**ParamÃ¨tres :**
- `query` (string, requis) : Terme de recherche

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/search?query=dandadan')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "query": "dandadan",
  "count": 1,
  "results": [
    {
      "id": "dandadan",
      "title": "Dandadan",
      "image": "https://cdn.statically.io/gh/Anime-Sama/IMG/img/contenu/dandadan0.jpg",
      "url": "https://anime-sama.fr/catalogue/dandadan/"
    }
  ]
}
```

### 2. DÃ©tails d'un anime

**Endpoint :** `GET /api/anime/:id`

**ParamÃ¨tres :**
- `id` (string, requis) : ID de l'anime

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/anime/dandadan')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "data": {
    "id": "dandadan",
    "title": "Dandadan",
    "alternativeTitles": "Dan Da Dan",
    "synopsis": "Momo Ayase et Ken Takakura sont tous deux lycÃ©ens...",
    "image": "https://cdn.statically.io/gh/Anime-Sama/IMG/img/contenu/dandadan0.jpg",
    "genres": ["Action", "Supernatural", "Comedy"],
    "status": "15 saisons disponibles",
    "correspondence": "Saison 1 Episode 12 -> Chapitre 34",
    "year": "2024",
    "type": "SÃ©rie + Films + OAV",
    "seasons": [
      {
        "number": 1,
        "name": "Saison 1",
        "value": "saison1",
        "type": "Saison",
        "url": "saison1/vostfr",
        "fullUrl": "https://anime-sama.fr/catalogue/dandadan/saison1/vostfr",
        "languages": ["VOSTFR"],
        "available": true
      }
    ],
    "totalSeasons": 15,
    "availableLanguages": ["VOSTFR", "VF"],
    "hasFilms": true,
    "hasOAV": true,
    "url": "https://anime-sama.fr/catalogue/dandadan/"
  }
}
```

### 3. Saisons d'un anime

**Endpoint :** `GET /api/seasons/:animeId`

**ParamÃ¨tres :**
- `animeId` (string, requis) : ID de l'anime

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/seasons/dandadan')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "animeId": "dandadan",
  "count": 15,
  "seasons": [
    {
      "number": 1,
      "name": "Saison 1",
      "value": "1",
      "languages": ["VOSTFR"],
      "available": true
    },
    {
      "number": 1,
      "name": "Saison 1 (Avec VF ADN)",
      "value": "1",
      "languages": ["VF"],
      "available": true
    }
  ]
}
```

### 4. Ã‰pisodes d'une saison

**Endpoint :** `GET /api/episodes/:animeId`

**ParamÃ¨tres :**
- `animeId` (string, requis) : ID de l'anime
- `season` (string, optionnel) : NumÃ©ro de saison (dÃ©faut: 1)
- `language` (string, optionnel) : Code de langue (dÃ©faut: vostfr)

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/episodes/dandadan?season=saison1&language=vostfr')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "animeId": "dandadan",
  "season": "saison1",
  "language": "VOSTFR",
  "count": 12,
  "episodes": [
    {
      "number": 1,
      "title": "Ã‰pisode 1",
      "url": "https://anime-sama.fr/catalogue/dandadan/saison1/vostfr/episode-1",
      "streamingSources": [
        {
          "server": "Sibnet",
          "url": "https://video.sibnet.ru/shell.php?videoid=5702327",
          "quality": "HD",
          "serverNumber": 1
        }
      ],
      "language": "VOSTFR",
      "season": 1,
      "available": true
    }
  ]
}
```

### 5. Sources de streaming pour un Ã©pisode

**Endpoint :** `GET /api/embed`

**ParamÃ¨tres :**
- `url` (string, requis) : URL de l'Ã©pisode

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/embed?url=https://anime-sama.fr/catalogue/dandadan/saison1/vf1/episode-1')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "url": "https://anime-sama.fr/catalogue/dandadan/saison1/vf1/episode-1",
  "sources": [
    {
      "server": "Sibnet",
      "url": "https://video.sibnet.ru/shell.php?videoid=5702327",
      "quality": "HD",
      "type": "streaming",
      "episode": 1,
      "serverNumber": 1
    },
    {
      "server": "SendVid",
      "url": "https://sendvid.com/embed/6kntwzl3",
      "quality": "HD",
      "type": "streaming",
      "episode": 1,
      "serverNumber": 4
    }
  ],
  "count": 5
}
```

### 6. Anime en tendance

**Endpoint :** `GET /api/trending`

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/trending')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "count": 20,
  "trending": [
    {
      "id": "dandadan",
      "title": "Dandadan",
      "image": "https://cdn.statically.io/gh/Anime-Sama/IMG/img/contenu/dandadan0.jpg",
      "url": "https://anime-sama.fr/catalogue/dandadan/",
      "type": "anime"
    }
  ]
}
```

### 7. Ã‰pisodes rÃ©cents

**Endpoint :** `GET /api/recent`

**Exemple de requÃªte :**
```javascript
fetch('http://localhost:5000/api/recent')
```

**RÃ©ponse :**
```json
{
  "success": true,
  "count": 30,
  "recent": [
    {
      "animeId": "dandadan",
      "animeTitle": "Dandadan",
      "season": 2,
      "episode": null,
      "language": "VOSTFR",
      "languageInfo": {
        "code": "vostfr",
        "name": "VOSTFR",
        "fullName": "Version Originale Sous-TitrÃ©e FranÃ§aise",
        "flag": "jp"
      },
      "contentType": "anime",
      "releaseTime": "18h30",
      "releaseDay": "Jeudi",
      "isFinale": false,
      "isPostponed": false,
      "image": "https://cdn.statically.io/gh/Anime-Sama/IMG/img/contenu/dandadan.jpg",
      "url": "https://anime-sama.fr/catalogue/dandadan/saison2/vostfr/",
      "isNew": true
    }
  ]
}
```

## Configuration du changement de langue

### Pour React Native

#### 1. Composant sÃ©lecteur de langue

```javascript
import React, { useState } from 'react';
import { View, Text, TouchableOpacity, Modal, FlatList } from 'react-native';

const LANGUAGES = [
  { code: 'vostfr', name: 'VOSTFR', flag: 'ðŸ‡¯ðŸ‡µ' },
  { code: 'vf', name: 'VF', flag: 'ðŸ‡«ðŸ‡·' },
  { code: 'vf1', name: 'VF ADN', flag: 'ðŸ‡«ðŸ‡·' },
  { code: 'vf2', name: 'VF Netflix', flag: 'ðŸ‡«ðŸ‡·' },
  { code: 'va', name: 'VA', flag: 'ðŸ‡ºðŸ‡¸' },
  { code: 'vkr', name: 'VKR', flag: 'ðŸ‡°ðŸ‡·' },
  { code: 'vcn', name: 'VCN', flag: 'ðŸ‡¨ðŸ‡³' },
  { code: 'vqc', name: 'VQC', flag: 'ðŸ‡¨ðŸ‡¦' }
];

const LanguageSelector = ({ selectedLanguage, onLanguageChange, availableLanguages }) => {
  const [modalVisible, setModalVisible] = useState(false);
  
  const filteredLanguages = LANGUAGES.filter(lang => 
    availableLanguages.includes(lang.code.toUpperCase())
  );

  return (
    <View>
      <TouchableOpacity 
        onPress={() => setModalVisible(true)}
        style={styles.languageButton}
      >
        <Text>{selectedLanguage} ðŸ”½</Text>
      </TouchableOpacity>

      <Modal visible={modalVisible} transparent animationType="slide">
        <View style={styles.modalContainer}>
          <View style={styles.modalContent}>
            <FlatList
              data={filteredLanguages}
              keyExtractor={(item) => item.code}
              renderItem={({ item }) => (
                <TouchableOpacity
                  style={styles.languageOption}
                  onPress={() => {
                    onLanguageChange(item.code);
                    setModalVisible(false);
                  }}
                >
                  <Text>{item.flag} {item.name}</Text>
                </TouchableOpacity>
              )}
            />
          </View>
        </View>
      </Modal>
    </View>
  );
};
```

#### 2. Service API avec gestion des langues

```javascript
class AnimeAPI {
  constructor(baseURL = 'http://localhost:5000') {
    this.baseURL = baseURL;
  }

  async searchAnime(query) {
    const response = await fetch(`${this.baseURL}/api/search?query=${encodeURIComponent(query)}`);
    return response.json();
  }

  async getAnimeDetails(animeId) {
    const response = await fetch(`${this.baseURL}/api/anime/${animeId}`);
    return response.json();
  }

  async getEpisodes(animeId, season = 'saison1', language = 'vostfr') {
    const response = await fetch(
      `${this.baseURL}/api/episodes/${animeId}?season=${season}&language=${language}`
    );
    return response.json();
  }

  async getStreamingSources(episodeUrl) {
    const response = await fetch(
      `${this.baseURL}/api/embed?url=${encodeURIComponent(episodeUrl)}`
    );
    return response.json();
  }

  async getTrending() {
    const response = await fetch(`${this.baseURL}/api/trending`);
    return response.json();
  }

  async getRecent() {
    const response = await fetch(`${this.baseURL}/api/recent`);
    return response.json();
  }
}

export default new AnimeAPI();
```

#### 3. Hook pour la gestion des langues

```javascript
import { useState, useEffect } from 'react';
import AsyncStorage from '@react-native-async-storage/async-storage';

export const useLanguageManager = () => {
  const [selectedLanguage, setSelectedLanguage] = useState('vostfr');

  useEffect(() => {
    loadSavedLanguage();
  }, []);

  const loadSavedLanguage = async () => {
    try {
      const saved = await AsyncStorage.getItem('preferred_language');
      if (saved) setSelectedLanguage(saved);
    } catch (error) {
      console.error('Error loading language preference:', error);
    }
  };

  const changeLanguage = async (languageCode) => {
    try {
      setSelectedLanguage(languageCode);
      await AsyncStorage.setItem('preferred_language', languageCode);
    } catch (error) {
      console.error('Error saving language preference:', error);
    }
  };

  return {
    selectedLanguage,
    changeLanguage
  };
};
```

## Serveurs de streaming supportÃ©s

L'API extrait les URLs authentiques de ces serveurs :

- **Sibnet** : `sibnet.ru`
- **SendVid** : `sendvid.com`
- **Vidmoly** : `vidmoly.to`
- **SmoothPre** : `smoothpre.com`
- **OneUpload** : `oneupload.to`
- **DoodStream** : `doodstream.com`
- **StreamTape** : `streamtape.com`
- **Upstream** : `upstream.to`
- **EmbedGram** : `embedgram.com`

## Gestion d'erreurs

Toutes les rÃ©ponses d'erreur suivent ce format :

```json
{
  "success": false,
  "error": "Description de l'erreur",
  "message": "Message dÃ©taillÃ© pour l'utilisateur"
}
```

## Codes d'Ã©tat HTTP

- `200` : SuccÃ¨s
- `400` : RequÃªte invalide
- `404` : Ressource non trouvÃ©e
- `500` : Erreur serveur

## Limites et considÃ©rations

- **DÃ©lai anti-bot** : L'API intÃ¨gre des dÃ©lais alÃ©atoires pour Ã©viter la dÃ©tection
- **Timeout** : 8 secondes par requÃªte
- **DonnÃ©es en temps rÃ©el** : Toutes les donnÃ©es proviennent directement d'anime-sama.fr
- **Pas de cache** : Les donnÃ©es sont toujours fraÃ®ches mais les requÃªtes peuvent Ãªtre plus lentes

## Support

Pour toute question ou problÃ¨me, vÃ©rifiez que :
1. L'URL de base est correcte
2. Les paramÃ¨tres sont bien encodÃ©s
3. L'anime existe sur anime-sama.fr
4. La langue demandÃ©e est disponible pour cet anime